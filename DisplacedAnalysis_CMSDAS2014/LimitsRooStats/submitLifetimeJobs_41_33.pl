#!/usr/bin/perl -w 

use strict;

my %efffactors;
my %long = ("e" => "Electron41", "mu" => "Muon33");

$efffactors{"e"} = {
    "1000_020_0.0495" => [0.00204038, 0.000675804456759498],
    "1000_020_0.075" => [0.00287104, 0.000896989715249846],
    "1000_020_0.15" => [0.00372058, 0.00108676699059918],
    "1000_020_0.4995" => [0.0037028, 0.00104591351783979],
    "1000_020_0.75" => [0.00343562, 0.000967531014167505],
    "1000_020_1.5" => [0.00269458, 0.000757723557675225],
    "1000_020_15" => [0.00023418, 6.814801901743e-05],
    "1000_020_3" => [0.0017306, 0.000488370806662315],
    "1000_020_30" => [7.206e-05, 2.14159693686744e-05],
    "1000_020_4.5" => [0.00119058, 0.000337793217007092],
    "1000_020_45" => [3.402e-05, 1.04416098375682e-05],
    "1000_050_0.132" => [0.00349954, 0.00121575741151926],
    "1000_050_0.2" => [0.00433118, 0.0013745915123032],
    "1000_050_0.4" => [0.00536836, 0.00159399765745876],
    "1000_050_1.332" => [0.0056124, 0.00162583361768663],
    "1000_050_2" => [0.00520726, 0.00150543560310762],
    "1000_050_4" => [0.00403032, 0.00116387128330241],
    "1000_050_40" => [0.0004079, 0.000125254156018872],
    "1000_050_8" => [0.00263044, 0.000761433151986437],
    "1000_050_80" => [0.00012796, 4.07265424999471e-05],
    "1000_050_12" => [0.00187016, 0.000546170307709967],
    "1000_050_120" => [6.198e-05, 2.01143236525616e-05],
    "1000_150_0.33" => [0.0078871, 0.00260815957510272],
    "1000_150_0.5" => [0.00790596, 0.00244827131602361],
    "1000_150_1" => [0.00725994, 0.0021241641980186],
    "1000_150_3.33" => [0.00577836, 0.00164611576530449],
    "1000_150_5" => [0.00505038, 0.00143673201947197],
    "1000_150_10" => [0.00358818, 0.00101990985547547],
    "1000_150_100" => [0.0005994, 0.00029657029790591],
    "1000_150_20" => [0.00231658, 0.000665118171347017],
    "1000_150_200" => [0.0002189, 0.000121054359690182],
    "1000_150_30" => [0.0018012, 0.000560705638637601],
    "1000_150_300" => [0.00011142, 6.34425429502948e-05],
    "1000_350_1.155" => [0.00658164, 0.00217274269198725],
    "1000_350_1.75" => [0.0068013, 0.00206998952432132],
    "1000_350_3.5" => [0.00613114, 0.00175346426344651],
    "1000_350_11.655" => [0.00390416, 0.00108437275870616],
    "1000_350_17.5" => [0.00310426, 0.00085926198071601],
    "1000_350_35" => [0.00190798, 0.000527596964752452],
    "1000_350_350" => [0.00013084, 3.81257422747414e-05],
    "1000_350_70" => [0.00105648, 0.000293670651608226],
    "1000_350_700" => [4.032e-05, 1.13049942945585e-05],
    "1000_350_105" => [0.00069714, 0.000195213626532576],
    "1000_350_1050" => [1.818e-05, 5.37740606612519e-06],
    "200_020_0.231" => [0.00046308, 0.00031313043521191],
    "200_020_0.35" => [0.00047688, 0.00024329490207565],
    "200_020_0.7" => [0.00048972, 0.000177910487425559],
    "200_020_2.331" => [0.00039578, 0.000119186425133066],
    "200_020_3.5" => [0.00033586, 9.9396907316073e-05],
    "200_020_7" => [0.00022804, 6.58676981835558e-05],
    "200_020_70" => [1.63e-05, 5.13688621637661e-06],
    "200_020_14" => [0.00013028, 3.80458924984025e-05],
    "200_020_140" => [4.12e-06, 8.30045781869892e-07],
    "200_020_21" => [8.644e-05, 2.62892857263182e-05],
    "200_020_210" => [2.06e-06, 4.16346009948456e-07],
    "200_050_0.66" => [0.00012338, 6.25322938648503e-05],
    "200_050_1" => [0.00021478, 9.71504500041045e-05],
    "200_050_2" => [0.0003083, 0.000116637280489559],
    "200_050_6.66" => [0.00022052, 6.7791869837024e-05],
    "200_050_10" => [0.0001784, 5.33052792882656e-05],
    "200_050_20" => [0.0001122, 3.26828640115887e-05],
    "200_050_200" => [7.98e-06, 2.54322944305071e-06],
    "200_050_40" => [6.204e-05, 1.86031627418566e-05],
    "200_050_400" => [2e-06, 4e-07],
    "200_050_60" => [4e-05, 1.27285662978986e-05],
    "200_050_600" => [1.98e-06, 3.96e-07],
    "400_020_0.132" => [0.00337924, 0.00146772336123126],
    "400_020_0.2" => [0.00312668, 0.00113769099253532],
    "400_020_0.4" => [0.00272334, 0.000840064313147511],
    "400_020_1.332" => [0.00232182, 0.0006672726816647],
    "400_020_2" => [0.0021371, 0.000611705524905571],
    "400_020_4" => [0.00162644, 0.000463852289143861],
    "400_020_40" => [0.00011432, 3.29759866569599e-05],
    "400_020_8" => [0.00098462, 0.000282083581542776],
    "400_020_80" => [3.412e-05, 1.04548254887396e-05],
    "400_020_12" => [0.00064874, 0.00018698824750235],
    "400_020_120" => [1.606e-05, 5.09922974575573e-06],
    "400_050_0.264" => [0.00361236, 0.00136012427696295],
    "400_050_0.4" => [0.00357662, 0.00119270195228146],
    "400_050_0.8" => [0.00322434, 0.000956844976693717],
    "400_050_2.664" => [0.00256708, 0.000720103876295636],
    "400_050_4" => [0.00229718, 0.000641360743182805],
    "400_050_8" => [0.00171304, 0.000477538334444472],
    "400_050_80" => [0.00016876, 5.05500574084738e-05],
    "400_050_16" => [0.00111098, 0.000311149566633155],
    "400_050_160" => [5.23e-05, 1.5832296106377e-05],
    "400_050_24" => [0.0007912, 0.000225313230858731],
    "400_050_240" => [2.614e-05, 7.91504794679097e-06],
    "400_150_1.32" => [0.00414974, 0.00162407354522632],
    "400_150_2" => [0.00378126, 0.0012664005192292],
    "400_150_4" => [0.00319222, 0.00093358482374983],
    "400_150_13.32" => [0.0018986, 0.000522144938115845],
    "400_150_20" => [0.00147506, 0.0004034664845362],
    "400_150_40" => [0.00089948, 0.00024500517875343],
    "400_150_400" => [7.086e-05, 2.12718307627717e-05],
    "400_150_80" => [0.00051818, 0.000143327318038119],
    "400_150_800" => [2.234e-05, 7.44057954732022e-06],
    "400_150_120" => [0.00035092, 9.86408954541675e-05],
    "400_150_1200" => [1.018e-05, 2.84452034620953e-06],
};
$efffactors{"mu"} = {
    "1000_020_0.0495" => [4.028e-05, 2.1435930957157e-05],
    "1000_020_0.075" => [9.284e-05, 4.37708695824061e-05],
    "1000_020_0.15" => [0.00019322, 7.93625146779007e-05],
    "1000_020_0.4995" => [0.00026056, 8.20462683124589e-05],
    "1000_020_0.75" => [0.00026624, 8.12656649760525e-05],
    "1000_020_1.5" => [0.00025984, 7.74512093127022e-05],
    "1000_020_15" => [0.00012348, 9.4368994993059e-05],
    "1000_020_3" => [0.00025312, 8.74318784883409e-05],
    "1000_020_30" => [4.578e-05, 3.87182532663859e-05],
    "1000_020_4.5" => [0.0002583, 0.000125926564314286],
    "1000_020_45" => [2.388e-05, 1.84489613799802e-05],
    "1000_050_0.132" => [0.005484, 0.00186058565080998],
    "1000_050_0.2" => [0.00680122, 0.00215944058745222],
    "1000_050_0.4" => [0.00800948, 0.0024228859122988],
    "1000_050_1.332" => [0.00756958, 0.00224914609055437],
    "1000_050_2" => [0.00689434, 0.002045487013751],
    "1000_050_4" => [0.00530738, 0.00157410844053896],
    "1000_050_40" => [0.00101038, 0.000525508354049676],
    "1000_050_8" => [0.00363414, 0.00108673143360446],
    "1000_050_80" => [0.00037426, 0.00021910294088396],
    "1000_050_12" => [0.00287842, 0.000925539462506056],
    "1000_050_120" => [0.00019106, 0.000115409811298693],
    "1000_150_0.33" => [0.01083058, 0.00355721708461207],
    "1000_150_0.5" => [0.01104934, 0.00343181005351753],
    "1000_150_1" => [0.0108722, 0.00324139327481255],
    "1000_150_3.33" => [0.01015068, 0.0029804247248498],
    "1000_150_5" => [0.0093947, 0.00275566260322268],
    "1000_150_10" => [0.0072359, 0.00212088573902509],
    "1000_150_100" => [0.00077188, 0.000241817351271574],
    "1000_150_20" => [0.0047086, 0.0013822631931727],
    "1000_150_200" => [0.00024792, 8.04572946102465e-05],
    "1000_150_30" => [0.0033735, 0.000997440302173519],
    "1000_150_300" => [0.00011996, 3.97406198240541e-05],
    "1000_350_1.155" => [0.01348142, 0.0044313131555619],
    "1000_350_1.75" => [0.0130104, 0.0040631245159852],
    "1000_350_3.5" => [0.0117416, 0.00351813976265867],
    "1000_350_11.655" => [0.00897454, 0.00264771209425496],
    "1000_350_17.5" => [0.00766544, 0.00225915000718058],
    "1000_350_35" => [0.00522938, 0.00154019986020516],
    "1000_350_350" => [0.00044014, 0.000135465495178662],
    "1000_350_70" => [0.0031237, 0.000921356533378909],
    "1000_350_700" => [0.00013606, 4.176399099703e-05],
    "1000_350_105" => [0.00214496, 0.000635817336397805],
    "1000_350_1050" => [6.602e-05, 2.06222408093786e-05],
    "200_020_0.231" => [0.00423386, 0.00203221623140452],
    "200_020_0.35" => [0.00322992, 0.00128329496915401],
    "200_020_0.7" => [0.00256828, 0.000826500025127646],
    "200_020_2.331" => [0.00205226, 0.000614572121971051],
    "200_020_3.5" => [0.00186004, 0.000553535167504288],
    "200_020_7" => [0.001421, 0.000422674112289835],
    "200_020_70" => [0.00014822, 4.78980660987477e-05],
    "200_020_14" => [0.00094572, 0.000282544719886959],
    "200_020_140" => [4.608e-05, 1.50362447439512e-05],
    "200_020_21" => [0.00068112, 0.00020594192719308],
    "200_020_210" => [2.204e-05, 7.39732816630437e-06],
    "200_050_0.66" => [0.00097936, 0.000427788783845486],
    "200_050_1" => [0.00142886, 0.000517729359012989],
    "200_050_2" => [0.00194614, 0.000611229755479885],
    "200_050_6.66" => [0.00185346, 0.000549717107669026],
    "200_050_10" => [0.00161116, 0.000476100824431128],
    "200_050_20" => [0.0011085, 0.000326431338569078],
    "200_050_200" => [0.0001316, 6.67853786393399e-05],
    "200_050_40" => [0.00068316, 0.00020473196483207],
    "200_050_400" => [4.384e-05, 2.53262516768668e-05],
    "200_050_60" => [0.00050024, 0.00016616116364542],
    "200_050_600" => [2.19e-05, 1.26617692286663e-05],
    "400_020_0.132" => [0.00423704, 0.00164829524553825],
    "400_020_0.2" => [0.00393178, 0.00135295261245027],
    "400_020_0.4" => [0.00382574, 0.00118357290806439],
    "400_020_1.332" => [0.00389476, 0.00116136350825398],
    "400_020_2" => [0.00366606, 0.00109102612844239],
    "400_020_4" => [0.00289412, 0.000859696259719676],
    "400_020_40" => [0.00035848, 0.000120640775925887],
    "400_020_8" => [0.001976, 0.000589655523165857],
    "400_020_80" => [0.00011612, 4.08956253895206e-05],
    "400_020_12" => [0.00146972, 0.000446901121878207],
    "400_020_120" => [5.606e-05, 2.10543806368176e-05],
    "400_050_0.264" => [0.00869972, 0.00305793022528899],
    "400_050_0.4" => [0.00823342, 0.0026289727986147],
    "400_050_0.8" => [0.00769652, 0.00230284400349134],
    "400_050_2.664" => [0.00689874, 0.00201842384684288],
    "400_050_4" => [0.00636838, 0.00186209197489705],
    "400_050_8" => [0.00497838, 0.0014538270445194],
    "400_050_80" => [0.00054694, 0.000167405425670735],
    "400_050_16" => [0.0033547, 0.000981812647912014],
    "400_050_160" => [0.0001736, 5.41705934986871e-05],
    "400_050_24" => [0.00243294, 0.000717065773652599],
    "400_050_240" => [8.38e-05, 2.59414186196515e-05],
    "400_150_1.32" => [0.00719884, 0.00240690449885823],
    "400_150_2" => [0.00777632, 0.00241198975157358],
    "400_150_4" => [0.00811094, 0.00239236547478515],
    "400_150_13.32" => [0.0064747, 0.00187384971798701],
    "400_150_20" => [0.00547996, 0.00158465167707733],
    "400_150_40" => [0.00369204, 0.00106703402497952],
    "400_150_400" => [0.00029696, 8.97796862547425e-05],
    "400_150_80" => [0.00218638, 0.000632798391729941],
    "400_150_800" => [9.036e-05, 2.83033776076284e-05],
    "400_150_120" => [0.0014862, 0.000432986417338928],
    "400_150_1200" => [4.418e-05, 1.32706629826848e-05],
};

foreach my $x (keys %efffactors) {
    my $leptype = $long{$x};
    my %effs = % {$efffactors{$x}};
    foreach my $tag (keys %effs) {
	$tag =~ /_(\d+)_/;
	my $m = $1;
	$m =~ s/^0//;
	my @eff = @ {$effs{$tag}};

	my $jobFileName = "job$x$tag";
	open JOBFILE, ">$jobFileName" or die "Couldn't open $jobFileName for writing: $!\n";
	print JOBFILE "source /afs/cern.ch/user/p/plujan/public/displacedfermions/trunk/LimitsRooStats/setup.sh\n";
	print JOBFILE "python mainSigmaBayesian.py $m $leptype $eff[0] $eff[1] $tag > /dev/null 2>&1\n";
	close JOBFILE;
	chmod 0755, $jobFileName;

	system("bsub -q cmscaf1nh $jobFileName");
    }
}

